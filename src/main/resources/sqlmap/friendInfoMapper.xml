<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="friendInfoMapper">
	<resultMap type="com.todo.api.userInfo.service.UserInfoVO" id="userInfoMap">
		<result property="userId"		column="USER_ID"/>
		<result property="password" 	column="PASSWORD"/>
		<result property="name" 		column="NAME"/>
		<result property="cellPhone" 	column="CELL_PHONE"/>
		<result property="birthDay" 	column="BIRTH_DAY"/>
		<result property="registDate" 	column="REGIST_DATE"/>
		<result property="changeDate" 	column="CHANGE_DATE"/>
		<result property="friendShowAt" column="FRIEND_SHOW_AT"/>
		<result property="userFrindAt" 	column="USER_FRIEND_AT"/>
	</resultMap>

	
	<select id="friendInfoMapper.selectFriendList" parameterType="userInfoVO" resultMap="userInfoMap">
		SELECT *
		FROM(
			SELECT  CASE 
						WHEN B.FRIEND_ID IS NOT NULL
						THEN 'Y'
						ELSE 'N'
					END USER_FRIEND_AT,
					A.USER_ID,
					A.NAME,
					CASE 
						WHEN B.FRIEND_SHOW_AT ='Y'
						THEN 'Y'
						ELSE 'N'
					END FRIEND_SHOW_AT
			FROM USER A
				LEFT JOIN USER_FRIEND B
					ON(		A.USER_ID = B.FRIEND_ID
						AND B.USER_ID = #{userId}
					)	
		) C
		WHERE USER_FRIEND_AT ='Y'		
	</select>


</mapper>